---
title: "Simulate Multivariate Skewed Gamma Data"
author: "Kazi Tanvir Hasan and Dr. Gabirel Odom"
output: 
  rmarkdown::html_vignette:
    toc: true
    toc_depth: 2
vignette: >
  %\VignetteIndexEntry{Simulate Multivariate Skewed Gamma Data}
  %\VignetteEngine{quarto::html}
  %\VignetteLanguage{en}
---


# Introduction

This vignette demonstrates how to generate multivariate skewed Gamma data using the function `generate_mvGamma_data()`. The function first generates multivariate normal samples, transforms them into Z-scores, and then applies a Gamma transformation using `qgamma` to each variable.

We will walk through an example where we generate multivariate skewed Gamma data with specified parameters.


## Setup

Before starting, we need to define the necessary parameters and load the required packages.

```{r setup, include=TRUE}
# Load the necessary library
library(simBKMRdata)  # Replace with your actual package name if needed

# Set parameters for the simulation
p <- 4  # Number of variables
N <- 1000  # Number of samples
shapeGamma_num <- c(0.5, 0.75, 1, 1.25)  # Shape parameters for the Gamma distribution
rateGamma_num <- 1:4  # Rate parameters for the Gamma distribution
mean_vec <- rep(0, p)  # Mean vector for the normal distribution
cov_mat <- diag(p)  # Covariance matrix (identity matrix here for simplicity)

# Set seed for reproducibility
set.seed(2025)
```


## Generate Multivariate Skewed Gamma Data
Next, we will use the generate_mvGamma_data() function to generate multivariate normal data and transform it into skewed Gamma data.

```{r}
# Generate the data
gamma_samples <- generate_mvGamma_data(
  sampSize = N,
  mean_vec = mean_vec,
  sampCorr_mat = cov_mat,
  shape_num = shapeGamma_num,
  rate_num = rateGamma_num
)

# View the first few rows of the Gamma samples
head(gamma_samples)
```


## Visualizing the Results
Let's visualize the first variable (column 1) of the normal samples and the Gamma-transformed samples.

```{r}
# Plot the density of the first and second variable for Gamma data
par(mfrow = c(2, 1))

# Density of first variable
plot(
  density(gamma_samples[, 1]), 
  main = "Density of First Gamma Feature (Variable 1)", 
  col = "blue"
)

plot(
  density(gamma_samples[, 2]), 
  main = "Density of Second Gamma Feature (Variable 2)", 
  col = "blue"
)

par(mfrow = c(1, 1))
```



# Summary

In this vignette, we demonstrated how to use the generate_mvGamma_data() function to generate multivariate skewed Gamma data. The steps involved generating multivariate normal samples, calculating their cumulative distribution function (CDF), and then applying a Gamma transformation using qgamma for each variable. The resulting data can be used in simulations where multivariate skewed distributions are needed.

We visualized the transformation process by comparing the density of the normal samples and the Gamma-transformed samples.
