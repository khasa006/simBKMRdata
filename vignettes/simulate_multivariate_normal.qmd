---
title: "Simulate Multivariate Normal Data"
author: "Kazi Tanvir Hasan and Dr. Gabirel Odom"
output: 
  rmarkdown::html_vignette:
    toc: true
    toc_depth: 2
vignette: >
  %\VignetteIndexEntry{Simulate Multivariate Normal Data}
  %\VignetteEngine{quarto::html}
  %\VignetteLanguage{en}
---


# Introduction

This vignette demonstrates how to generate multivariate normal data using the function `MASS::mvrnorm()`. We will simulate data from a multivariate normal distribution with a specified mean vector and covariance matrix. This method is commonly used in simulations and can be used as a basis for generating multivariate data with other transformations.

In this example, we will generate multivariate normal data with specific parameters and visualize the results.


## Setup

Before starting, we need to load the required package and set the necessary parameters for the simulation.

```{r setup, include=TRUE}
# Load the necessary library
library(MASS)

# Set parameters for the simulation
p <- 4  # Number of variables
N <- 1000  # Number of samples
mean_vec <- rep(0, p)  # Mean vector for the multivariate normal distribution
cov_mat <- diag(p)  # Covariance matrix (identity matrix here for simplicity)

# Set seed for reproducibility
set.seed(2025)
```


## Generate Multivariate Normal Data

Next, we will use the MASS::mvrnorm() function to generate multivariate normal data with the specified parameters.

```{r}
# Generate the data
mvnorm_samples <- mvrnorm(n = N, mu = mean_vec, Sigma = cov_mat)

# View the first few rows of the simulated data
head(mvnorm_samples)
```


## Visualizing the Results
Let's visualize the first two variables of the generated multivariate normal data to better understand its structure.

```{r}
# Plot the first two variables of the multivariate normal data
plot(
  mvnorm_samples[, 1], 
  mvnorm_samples[, 2], 
  main = "Scatterplot of First Two Variables of Multivariate Normal Data",
  xlab = "Variable 1", 
  ylab = "Variable 2", 
  pch = 19,
  col = "blue"
)
```

Additionally, we will plot the histograms of the first variable.

```{r}
# Plot the histogram of the first variable
hist(
  mvnorm_samples[, 1], 
  main = "Histogram of First Variable", 
  xlab = "Value", 
  col = "lightblue", 
  border = "blue"
)
```



# Summary

In this vignette, we demonstrated how to use the MASS::mvrnorm() function to generate multivariate normal data. The steps involved specifying a mean vector and a covariance matrix, and then simulating the data with the given parameters. We visualized the first two variables of the data in a scatterplot and examined the distribution of the first variable using a histogram.

The generated multivariate normal data can be used for simulations or as input for further analysis that requires normally distributed variables.
